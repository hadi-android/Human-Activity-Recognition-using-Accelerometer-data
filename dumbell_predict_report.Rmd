---
title: "Dumbell exercise mistake detection"
author: "Hadi Tadayyon"
date: "September 2, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

Clear all variables and load the required libraries
```{r, warning=FALSE}
rm(list=ls(all=T))
library(caret)
library(e1071)
```

Read training set
```{r}
data_tr = read.csv("pml-training.csv",header=T)
```

Remove NA and "" columns
```{r}
data_tr = data_tr[,-which(data_tr[1,]=="")]
data_tr = data_tr[,-which(is.na(data_tr[1,]))]
```

Read testing set
```{r}
data_te = read.csv("pml-testing.csv", header=T)
```

Remove NA columns frin testing set
```{r}
data_te = data_te[,-which(is.na(data_te[1,]))]
```

Remove non-relevant columns related to person, date, time stamp, and window
```{r}
data_tr=data_tr[,-c(1:7)]
data_te=data_te[,-c(1:7)]
```

Check if the number of columns of the two data sets are the same
```{r}
dim(data_tr)
dim(data_te)
```

Set up a 10-fold cross validation
```{r}
ctrl <- trainControl(method = "repeatedcv", number = 10, savePredictions = TRUE)
```

Train using random forests and using all features
```{r, eval=FALSE}
rfmodel2 = train(data_tr$classe ~., data = data_tr, method = "rf", verbose = FALSE, trControl=ctrl)
```
Here is the result of the built model. It shows that the best accuracy was obtained for mtry = 2 with accuracy of 0.84.This accuracy also considers the out-of-sample error.

  mtry  Accuracy   Kappa      Accuracy SD  Kappa SD   			
  2     0.8424984  0.8007024  0.003803663  0.004747850			
  3     0.8379626  0.7949628  0.004125241  0.005164086			
  5     0.8266954  0.7806995  0.004854413  0.006090015			

Accuracy was used to select the optimal model using  the largest value.
The final value used for the model was mtry = 2.

Next, predict class from testing set using the newly obtained model
```{r, eval=FALSE}
pred = predict(rfmodel2,data_te[,-53])
pred
```
 [1] B A B A A E D B A A A C B A E E C B B B


